<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <title>Sistema de Cadastro CDS</title>

    <!--o uso do defer é é fazer com que o navegador execute o script após o
    carregamento completo do HTML-->
  </head>
  <body>
    <style>
    /* styles.css */
body {
  font-family: Arial, sans-serif;
  background-color: #f0f0f0;
}

header {
  text-align: center;
  background-color: white;
  color: #fff;
}

.logocds {
  width: 10%;
  padding-top: 30px;
}

h1 {
  text-align: center;
}

.camposdigitacao {
  max-width: 600px;
  margin: 20px auto;
  background-color: #fff;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0px 0px 10px 0px rgba(0, 0, 0, 0.1);
}

label {
  display: block;
  margin-bottom: 5px;
}

input[type="text"] {
  width: calc(100% - 10px);
  padding: 10px;
  margin-bottom: 15px;
  border: 1px solid #ccc;
  border-radius: 4px;
}

.cadastro {
  text-align: center;
}

.btCadastro {
  padding: 10px 20px;
  background-color: #333;
  color: #fff;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

.btCadastro:hover {
  background-color: #555;
}

.tabela {
  max-width: 800px;
  margin: 20px auto;
  background-color: #fff;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0px 0px 10px 0px rgba(0, 0, 0, 0.1);
}

table {
  width: 100%;
  border-collapse: collapse;
}

th,
td {
  padding: 10px;
  border-bottom: 1px solid #ccc;
}

th {
  background-color: #333;
  color: #fff;
}
    </style>
   
  <body>
    <header >
      <img class="logocds" src="logocds.png" />
      <h1 class="titulo">Sistema de Cadastro de Visitantes ao CDS</h1>
    </header>

    <h1>Cadastro de Visitantes</h1>
    <form id="cadastroForm">
      <section class="camposdigitacao">
        <div>
          <label for="nome">NOME: </label>
          <input type="text" id="nome" name="nomecompleto" />
        </div>
        <div>
          <label for="om">OM DE ORIGEM: </label>
          <input type="text" id="om" name="om" />
        </div>
        <div>
          <label for="destino">DESTINO: </label>
          <input
            type="text"
            id="destino"
            name="destino"
          />
        </div>
        <div>
          <label for="ramal">RAMAL: </label>
          <input type="text" id="ramal" name="ramal"  />
        </div>

        <div>
        
          <button type="submit" class="btCadastro">cadastrar visitante</button>
          
        </div>

      </section>
    </form>
    <section class="tabela">
      <table id="tabela">
        <thead>
          <tr>
            <th>Nome</th>
            <th>Identidade Militar</th>
            <th>OM de Origem</th>
            <th>Celular</th>
            <th>Horário de Entrada</th>
            <th>Horário de Saída</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody class="tabela-corpo"></tbody>
      </table>
    </section>
    <script>function adicionarPessoa(nome, idmilitar, om, celular, horarioEntradaTexto, horarioSaidaTexto = '') {
    const linha = tabelaCorpo.insertRow();

    const tdNome = document.createElement("td");
    const tdIdMilitar = document.createElement("td");
    const tdOm = document.createElement("td");
    const tdCelular = document.createElement("td");
    const tdEntrada = document.createElement("td");
    const tdSaida = document.createElement("td");
    const tdAcoes = document.createElement("td");

    tdNome.textContent = nome;
    tdIdMilitar.textContent = idmilitar;
    tdOm.textContent = om;
    tdCelular.textContent = celular;
    tdEntrada.textContent = horarioEntradaTexto;
    tdSaida.textContent = horarioSaidaTexto;

    // Botão de excluir
    const btnExcluir = document.createElement("button");
    btnExcluir.textContent = "Excluir";
    btnExcluir.addEventListener("click", () => {
        linha.remove();
        removerPessoaLocalStorage(nome, horarioEntradaTexto);
    });

    // Botão de adicionar saída
    const btnSaida = document.createElement("button");
    btnSaida.textContent = "Adicionar-Saída";
    btnSaida.addEventListener("click", () => {
        const horarioSaida = new Date().toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
        tdSaida.textContent = horarioSaida;
        atualizarSaidaLocalStorage(nome, horarioEntradaTexto, horarioSaida);
    });

    tdAcoes.appendChild(btnExcluir);
    tdAcoes.appendChild(btnSaida);

    linha.appendChild(tdNome);
    linha.appendChild(tdIdMilitar);
    linha.appendChild(tdOm);
    linha.appendChild(tdCelular);
    linha.appendChild(tdEntrada);
    linha.appendChild(tdSaida);
    linha.appendChild(tdAcoes);
}

function atualizarSaidaLocalStorage(nome, entrada, saida) {
    let pessoas = JSON.parse(localStorage.getItem('pessoas')) || [];
    pessoas = pessoas.map(p => {
        if (p.nome === nome && p.horario === entrada) {
            return { ...p, horarioSaida: saida };
        }
        return p;
    });
    localStorage.setItem('pessoas', JSON.stringify(pessoas));
}

function removerPessoaLocalStorage(nome, entrada) {
    let pessoas = JSON.parse(localStorage.getItem('pessoas')) || [];
    pessoas = pessoas.filter(p => !(p.nome === nome && p.horario === entrada));
    localStorage.setItem('pessoas', JSON.stringify(pessoas));
}

function puxarPessoa() {
    const pessoas = JSON.parse(localStorage.getItem('pessoas')) || [];
    pessoas.forEach(pessoa => {
        const { nome, om, destino, ramal, horario, horarioSaida } = pessoa;
        adicionarPessoa(nome, om, destino, ramal, horario, horarioSaida);
    });
}</script>

  </body>
</html>
